{% extends 'portal/shared/base_portal.html' %}
{% load static %}

{% block title %}Review Detail - Instructor Portal{% endblock %}

{% block sidebar_subtitle %}Manage your courses and students{% endblock %}

{% block sidebar_nav %}
<a href="{% url 'portal:instructor_dashboard' %}" class="nav-link">
    <i class="fas fa-tachometer-alt"></i>
    Dashboard
</a>
<a href="{% url 'portal:instructor_courses' %}" class="nav-link">
    <i class="fas fa-book"></i>
    My Courses
</a>
<a href="{% url 'portal:instructor_students' %}" class="nav-link">
    <i class="fas fa-users"></i>
    Students
</a>
<a href="{% url 'portal:instructor_assignments' %}" class="nav-link">
    <i class="fas fa-tasks"></i>
    Assignments
</a>
<a href="{% url 'portal:instructor_quizzes' %}" class="nav-link">
    <i class="fas fa-question-circle"></i>
    Quizzes
</a>
<a href="{% url 'portal:instructor_attendance' %}" class="nav-link">
    <i class="fas fa-calendar-check"></i>
    Attendance
</a>
<a href="{% url 'portal:instructor_analytics' %}" class="nav-link">
    <i class="fas fa-chart-line"></i>
    Analytics
</a>
<a href="{% url 'portal:instructor_reviews' %}" class="nav-link active">
    <i class="fas fa-star"></i>
    Reviews
</a>
{% endblock %}

{% block content %}
<div class="portal-card">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-star"></i>
            Review Details
        </h3>
        <a href="{% url 'portal:instructor_reviews' %}" class="btn-secondary-portal">
            <i class="fas fa-arrow-left"></i>
            Back to Reviews
        </a>
    </div>
    
    <div class="card-body">
        <div class="row mb-4">
            <div class="col-md-6">
                <h5>Student Information</h5>
                <p><strong>Name:</strong> {{ review.user.get_full_name|default:review.user.username }}</p>
                <p><strong>Email:</strong> {{ review.user.email }}</p>
                <p><strong>Username:</strong> {{ review.user.username }}</p>
            </div>
            <div class="col-md-6">
                <h5>Course Information</h5>
                <p><strong>Course:</strong> {{ review.course.title }}</p>
                <p><strong>Instructor:</strong> {{ review.course.instructor.get_full_name|default:review.course.instructor.username }}</p>
                <p><strong>Price:</strong> ${{ review.course.price }}</p>
            </div>
        </div>
        
        <hr>
        
        <div class="mb-4">
            <h5>Rating</h5>
            <div class="d-flex align-items-center mb-3">
                {% for i in "12345" %}
                    {% if forloop.counter <= review.rating %}
                        <i class="fas fa-star text-warning" style="font-size: 2rem;"></i>
                    {% else %}
                        <i class="far fa-star text-muted" style="font-size: 2rem;"></i>
                    {% endif %}
                {% endfor %}
                <span class="ms-3" style="font-size: 1.5rem; font-weight: 700;">{{ review.rating }}/5</span>
            </div>
        </div>
        
        <div class="mb-4">
            <h5>Comment</h5>
            <div class="p-3 bg-light rounded">
                {% if review.comment %}
                    <p style="white-space: pre-wrap;">{{ review.comment }}</p>
                {% else %}
                    <p class="text-muted">No comment provided.</p>
                {% endif %}
            </div>
        </div>
        
        <div class="row mb-4">
            <div class="col-md-6">
                <p><strong>Review Date:</strong> {{ review.created_at|date:"F d, Y g:i A" }}</p>
                <p><strong>Last Updated:</strong> {{ review.updated_at|date:"F d, Y g:i A" }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Verified Purchase:</strong> 
                    {% if review.is_verified_purchase %}
                        <span class="badge bg-success">
                            <i class="fas fa-check-circle"></i> Yes
                        </span>
                    {% else %}
                        <span class="badge bg-secondary">No</span>
                    {% endif %}
                </p>
            </div>
        </div>
        
        {% if enrollment %}
        <hr>
        <div class="mb-4">
            <h5>Enrollment Information</h5>
            <p><strong>Enrolled Date:</strong> {{ enrollment.created_at|date:"F d, Y" }}</p>
            <p><strong>Progress:</strong> {{ enrollment.progress_percent|default:0 }}%</p>
            <p><strong>Status:</strong> 
                <span class="badge bg-{{ enrollment.status|lower }}">{{ enrollment.get_status_display }}</span>
            </p>
        </div>
        {% endif %}
        
        <hr>
        
        <div class="d-flex gap-2">
            <a href="{% url 'portal:instructor_review_delete' review.id %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this review? This action cannot be undone.');">
                <i class="fas fa-trash"></i>
                Delete Review
            </a>
            <a href="{% url 'portal:instructor_course_detail' review.course.id %}" class="btn-secondary-portal">
                <i class="fas fa-book"></i>
                View Course
            </a>
        </div>
    </div>
</div>
{% endblock %}











